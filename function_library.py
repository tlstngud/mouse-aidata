"""
함수 라이브러리 시스템

모델이 출력하는 함수 ID(113-998)를 실제 명령어 시퀀스로 변환

⚠️  명령어 체계: 절대 좌표 (Absolute Coordinates)
   0 = up (x-1)
   1 = down (x+1)
   2 = left (y-1)
   3 = right (y+1)
"""

# 함수 라이브러리 정의 (886개)
FUNCTION_LIBRARY = {}

# ===== Tier 1: 기본 조합 (113-149) =====
# 2-3개 명령어 조합 (절대 좌표)
FUNCTION_LIBRARY.update({
    113: [1, 2],           # down + left
    114: [3, 2],           # right + left
    115: [2, 1, 2],        # left + down + left
    116: [2, 3, 2],        # left + right + left
    117: [1, 1],           # down x2
    118: [3, 3],           # right x2
    119: [1, 2, 2],        # down + left x2
    120: [3, 2, 2],        # right + left x2
    121: [2, 2, 1],        # left x2 + down
    122: [2, 2, 3],        # left x2 + right
    123: [1, 1, 2],        # down x2 + left
    124: [3, 3, 2],        # right x2 + left
    125: [2, 1, 2, 2],     # left + down + left x2
    126: [2, 3, 2, 2],     # left + right + left x2
    127: [1, 2, 1, 2],     # (down + left) x2
    128: [3, 2, 3, 2],     # (right + left) x2
    129: [2, 2, 2],        # left x3
    130: [2, 2, 2, 2],     # left x4
    131: [1, 1, 1],        # down x3
    132: [3, 3, 3],        # right x3
    133: [0, 2],           # up + left
    134: [2, 0],           # left + up
    135: [1, 2, 3],        # down + left + right
    136: [3, 2, 1],        # right + left + down
    137: [2, 1, 1, 2],     # left + down x2 + left
    138: [2, 3, 3, 2],     # left + right x2 + left
    139: [1, 2, 2, 2],     # down + left x3
    140: [3, 2, 2, 2],     # right + left x3
    141: [2, 2, 1, 2],     # left x2 + down + left
    142: [2, 2, 3, 2],     # left x2 + right + left
    143: [1, 1, 2, 2],     # down x2 + left x2
    144: [3, 3, 2, 2],     # right x2 + left x2
    145: [2, 1, 2, 1],     # left + down + left + down
    146: [2, 3, 2, 3],     # left + right + left + right
    147: [1, 2, 1],        # down + left + down
    148: [3, 2, 3],        # right + left + right
    149: [2, 2, 2, 1],     # left x3 + down
})

# ===== Tier 1.5: 고급 조합 (150-199) =====
# 5-10개 토큰을 활용한 복잡한 패턴
FUNCTION_LIBRARY.update({
    # 긴 지그재그 패턴 (10개)
    150: [2, 1, 2, 3, 2, 1, 2, 3, 2, 1],  # 앞좌앞우앞좌앞우앞좌 (지그재그 긴 패턴)
    151: [2, 3, 2, 1, 2, 3, 2, 1, 2, 3],  # 앞우앞좌앞우앞좌앞우
    152: [1, 2, 1, 2, 1, 2, 1, 2, 1, 2],  # 좌앞 5회 반복
    153: [3, 2, 3, 2, 3, 2, 3, 2, 3, 2],  # 우앞 5회 반복

    # 나선형 패턴 (9-10개)
    154: [2, 1, 2, 2, 1, 2, 2, 2, 1, 2],  # 나선형 확장 (앞+좌+앞2+좌+앞3+좌+앞)
    155: [2, 3, 2, 2, 3, 2, 2, 2, 3, 2],  # 나선형 확장 (우회전)
    156: [1, 2, 1, 2, 2, 1, 2, 2, 2],     # 좌앞+좌앞2+좌앞3
    157: [3, 2, 3, 2, 2, 3, 2, 2, 2],     # 우앞+우앞2+우앞3

    # 탐색 패턴 (8-10개)
    158: [2, 2, 1, 2, 2, 3, 2, 2, 0, 2],  # 앞2좌앞2우앞2뒤앞 (4방향 탐색)
    159: [1, 2, 2, 3, 2, 2, 0, 2, 2, 1],  # 좌앞2우앞2뒤앞2좌
    160: [2, 1, 2, 1, 2, 3, 2, 3, 2],     # 앞좌앞좌앞우앞우앞
    161: [2, 3, 2, 3, 2, 1, 2, 1, 2],     # 앞우앞우앞좌앞좌앞

    # 복잡한 회전 패턴 (7-9개)
    162: [1, 1, 2, 3, 3, 2, 1, 2, 3],     # 좌2앞우2앞좌앞우
    163: [3, 3, 2, 1, 1, 2, 3, 2, 1],     # 우2앞좌2앞우앞좌
    164: [2, 1, 1, 2, 3, 3, 2, 0, 2],     # 앞좌2앞우2앞뒤앞
    165: [2, 3, 3, 2, 1, 1, 2, 0, 2],     # 앞우2앞좌2앞뒤앞

    # 긴 전진 후 회전 (7-9개)
    166: [2, 2, 2, 2, 1, 2, 2, 2],        # 앞4좌앞3
    167: [2, 2, 2, 2, 3, 2, 2, 2],        # 앞4우앞3
    168: [2, 2, 2, 1, 2, 2, 2, 2],        # 앞3좌앞4
    169: [2, 2, 2, 3, 2, 2, 2, 2],        # 앞3우앞4

    # 왕복 패턴 (7-8개)
    170: [2, 2, 2, 0, 2, 2, 2],           # 앞3뒤앞3 (왕복)
    171: [1, 2, 2, 3, 2, 2],              # 좌앞2우앞2
    172: [3, 2, 2, 1, 2, 2],              # 우앞2좌앞2
    173: [2, 1, 2, 0, 2, 3, 2],           # 앞좌앞뒤앞우앞

    # 복잡한 경로 (6-9개)
    174: [1, 2, 3, 2, 1, 2, 3, 2],        # 좌앞우앞좌앞우앞
    175: [3, 2, 1, 2, 3, 2, 1, 2],        # 우앞좌앞우앞좌앞
    176: [2, 1, 2, 2, 3, 2, 2],           # 앞좌앞2우앞2
    177: [2, 3, 2, 2, 1, 2, 2],           # 앞우앞2좌앞2

    # 긴 조합 (6-8개)
    178: [1, 1, 2, 2, 3, 3, 2, 2],        # 좌2앞2우2앞2
    179: [3, 3, 2, 2, 1, 1, 2, 2],        # 우2앞2좌2앞2
    180: [2, 2, 1, 1, 2, 2, 3, 3],        # 앞2좌2앞2우2
    181: [2, 2, 3, 3, 2, 2, 1, 1],        # 앞2우2앞2좌2

    # 추가 복잡 패턴 (5-7개)
    182: [1, 2, 1, 2, 2, 3, 2],           # 좌앞좌앞2우앞
    183: [3, 2, 3, 2, 2, 1, 2],           # 우앞우앞2좌앞
    184: [2, 1, 2, 3, 2, 0, 2],           # 앞좌앞우앞뒤앞
    185: [2, 3, 2, 1, 2, 0, 2],           # 앞우앞좌앞뒤앞
    186: [1, 2, 2, 1, 2, 2, 1],           # 좌앞2좌앞2좌
    187: [3, 2, 2, 3, 2, 2, 3],           # 우앞2우앞2우
    188: [2, 1, 1, 2, 2, 3, 3],           # 앞좌2앞2우2
    189: [2, 3, 3, 2, 2, 1, 1],           # 앞우2앞2좌2
    190: [1, 2, 2, 2, 3, 2, 2],           # 좌앞3우앞2
    191: [3, 2, 2, 2, 1, 2, 2],           # 우앞3좌앞2
    192: [2, 2, 1, 2, 3, 2],              # 앞2좌앞우앞
    193: [2, 2, 3, 2, 1, 2],              # 앞2우앞좌앞
    194: [1, 2, 3, 2, 2],                 # 좌앞우앞2
    195: [3, 2, 1, 2, 2],                 # 우앞좌앞2
    196: [2, 1, 3, 2],                    # 앞좌우앞
    197: [2, 3, 1, 2],                    # 앞우좌앞
    198: [1, 2, 0, 2],                    # 좌앞뒤앞
    199: [3, 2, 0, 2],                    # 우앞뒤앞
})

# ===== Tier 2: LOOP 활용 (200-299) =====
# LOOP를 사용한 효율적인 패턴

# 앞으로 이동 (LOOP)
FUNCTION_LIBRARY.update({
    200: [110, 102, 2],    # LOOP 앞2
    201: [110, 103, 2],    # LOOP 앞3
    202: [110, 104, 2],    # LOOP 앞4
    203: [110, 105, 2],    # LOOP 앞5
    204: [110, 106, 2],    # LOOP 앞6
    205: [110, 107, 2],    # LOOP 앞7
    206: [110, 108, 2],    # LOOP 앞8
    207: [110, 109, 2],    # LOOP 앞9
    208: [110, 100, 2],    # LOOP 앞10
    209: [110, 105, 2, 1, 2],  # LOOP 5회 (앞+좌+앞) - 10개 토큰 활용
})

# 회전 (LOOP)
FUNCTION_LIBRARY.update({
    210: [110, 102, 1],    # LOOP 좌회 2번
    211: [110, 102, 3],    # LOOP 우회 2번
    212: [110, 103, 1],    # LOOP 좌회 3번
    213: [110, 103, 3],    # LOOP 우회 3번
    214: [110, 104, 1],    # LOOP 좌회 4번
    215: [110, 104, 3],    # LOOP 우회 4번
    216: [110, 105, 1],    # LOOP 좌회 5번
    217: [110, 105, 3],    # LOOP 우회 5번
    218: [110, 106, 1],    # LOOP 좌회 6번
    219: [110, 106, 3],    # LOOP 우회 6번
})

# 좌회+앞 (LOOP)
FUNCTION_LIBRARY.update({
    220: [110, 102, 1, 2], # LOOP (좌+앞) 2번
    221: [110, 103, 1, 2], # LOOP (좌+앞) 3번
    222: [110, 104, 1, 2], # LOOP (좌+앞) 4번
    223: [110, 105, 1, 2], # LOOP (좌+앞) 5번
    224: [110, 106, 1, 2], # LOOP (좌+앞) 6번
    225: [110, 107, 1, 2], # LOOP (좌+앞) 7번
    226: [110, 108, 1, 2], # LOOP (좌+앞) 8번
    227: [110, 109, 1, 2], # LOOP (좌+앞) 9번
    228: [110, 100, 1, 2], # LOOP (좌+앞) 10번
    229: [110, 104, 1, 2, 3],  # LOOP 4회 (좌+앞+우) - 8개
})

# 우회+앞 (LOOP)
FUNCTION_LIBRARY.update({
    230: [110, 102, 3, 2], # LOOP (우+앞) 2번
    231: [110, 103, 3, 2], # LOOP (우+앞) 3번
    232: [110, 104, 3, 2], # LOOP (우+앞) 4번
    233: [110, 105, 3, 2], # LOOP (우+앞) 5번
    234: [110, 106, 3, 2], # LOOP (우+앞) 6번
    235: [110, 107, 3, 2], # LOOP (우+앞) 7번
    236: [110, 108, 3, 2], # LOOP (우+앞) 8번
    237: [110, 109, 3, 2], # LOOP (우+앞) 9번
    238: [110, 100, 3, 2], # LOOP (우+앞) 10번
    239: [110, 104, 3, 2, 1],  # LOOP 4회 (우+앞+좌) - 8개
})

# 앞+좌회 (LOOP)
FUNCTION_LIBRARY.update({
    240: [110, 102, 2, 1], # LOOP (앞+좌) 2번
    241: [110, 103, 2, 1], # LOOP (앞+좌) 3번
    242: [110, 104, 2, 1], # LOOP (앞+좌) 4번
    243: [110, 105, 2, 1], # LOOP (앞+좌) 5번
    244: [110, 106, 2, 1], # LOOP (앞+좌) 6번
    245: [110, 107, 2, 1], # LOOP (앞+좌) 7번
    246: [110, 108, 2, 1], # LOOP (앞+좌) 8번
    247: [110, 109, 2, 1], # LOOP (앞+좌) 9번
    248: [110, 100, 2, 1], # LOOP (앞+좌) 10번
    249: [110, 103, 2, 1, 2],  # LOOP 3회 (앞+좌+앞) - 9개
})

# 앞+우회 (LOOP)
FUNCTION_LIBRARY.update({
    250: [110, 102, 2, 3], # LOOP (앞+우) 2번
    251: [110, 103, 2, 3], # LOOP (앞+우) 3번
    252: [110, 104, 2, 3], # LOOP (앞+우) 4번
    253: [110, 105, 2, 3], # LOOP (앞+우) 5번
    254: [110, 106, 2, 3], # LOOP (앞+우) 6번
    255: [110, 107, 2, 3], # LOOP (앞+우) 7번
    256: [110, 108, 2, 3], # LOOP (앞+우) 8번
    257: [110, 109, 2, 3], # LOOP (앞+우) 9번
    258: [110, 100, 2, 3], # LOOP (앞+우) 10번
    259: [110, 103, 2, 3, 2],  # LOOP 3회 (앞+우+앞) - 9개
})

# LOOP + IF 조합 (260-279)
FUNCTION_LIBRARY.update({
    260: [110, 103, 2, 5, 102, 1],  # LOOP 3 앞 + IF 2 좌 - 9개
    261: [110, 103, 2, 5, 102, 3],  # LOOP 3 앞 + IF 2 우 - 9개
    262: [110, 104, 2, 5, 103, 1],  # LOOP 4 앞 + IF 3 좌 - 9개
    263: [110, 104, 2, 5, 103, 3],  # LOOP 4 앞 + IF 3 우 - 9개
    264: [110, 102, 1, 5, 102, 2],  # LOOP 2 좌 + IF 2 앞 - 9개
    265: [110, 102, 3, 5, 102, 2],  # LOOP 2 우 + IF 2 앞 - 9개
    266: [5, 103, 2, 110, 102, 1],  # IF 3 앞 + LOOP 2 좌 - 9개
    267: [5, 103, 2, 110, 102, 3],  # IF 3 앞 + LOOP 2 우 - 9개
    268: [5, 104, 2, 110, 103, 2],  # IF 4 앞 + LOOP 3 앞 - 9개
    269: [5, 105, 2, 110, 104, 2],  # IF 5 앞 + LOOP 4 앞 - 9개
    270: [110, 103, 2, 1, 2, 3, 2],  # LOOP 3 앞 + 좌앞우앞 - 10개
    271: [110, 103, 2, 3, 2, 1, 2],  # LOOP 3 앞 + 우앞좌앞 - 10개
    272: [110, 104, 2, 1, 2, 2],  # LOOP 4 앞 + 좌앞2 - 9개
    273: [110, 104, 2, 3, 2, 2],  # LOOP 4 앞 + 우앞2 - 9개
    274: [110, 102, 1, 2, 3, 2],  # LOOP 2 (좌앞우앞) - 9개
    275: [110, 102, 3, 2, 1, 2],  # LOOP 2 (우앞좌앞) - 9개
    276: [110, 102, 2, 1, 2, 3],  # LOOP 2 (앞좌앞우) - 9개
    277: [110, 102, 2, 3, 2, 1],  # LOOP 2 (앞우앞좌) - 9개
    278: [110, 103, 1, 2, 1, 2],  # LOOP 3 (좌앞좌앞) - 9개
    279: [110, 103, 3, 2, 3, 2],  # LOOP 3 (우앞우앞) - 9개
})

# IF 복잡 패턴 (280-299)
FUNCTION_LIBRARY.update({
    280: [5, 103, 2, 1, 2, 3, 2],  # IF 3 앞 + 좌앞우앞 - 10개
    281: [5, 103, 2, 3, 2, 1, 2],  # IF 3 앞 + 우앞좌앞 - 10개
    282: [5, 104, 2, 1, 2, 2],  # IF 4 앞 + 좌앞2 - 9개
    283: [5, 104, 2, 3, 2, 2],  # IF 4 앞 + 우앞2 - 9개
    284: [5, 105, 2, 1, 2],  # IF 5 앞 + 좌앞 - 8개
    285: [5, 105, 2, 3, 2],  # IF 5 앞 + 우앞 - 8개
    286: [5, 106, 2, 1],  # IF 6 앞 + 좌 - 7개
    287: [5, 106, 2, 3],  # IF 6 앞 + 우 - 7개
    288: [5, 102, 1, 2, 3, 2],  # IF 2 (좌앞우앞) - 9개
    289: [5, 102, 3, 2, 1, 2],  # IF 2 (우앞좌앞) - 9개
    290: [5, 103, 1, 2, 2],  # IF 3 (좌앞2) - 8개
    291: [5, 103, 3, 2, 2],  # IF 3 (우앞2) - 8개
    292: [5, 104, 1, 2],  # IF 4 (좌앞) - 7개
    293: [5, 104, 3, 2],  # IF 4 (우앞) - 7개
    294: [5, 105, 1],  # IF 5 좌 - 6개
    295: [5, 105, 3],  # IF 5 우 - 6개
    296: [5, 106, 1],  # IF 6 좌 - 6개
    297: [5, 106, 3],  # IF 6 우 - 6개
    298: [5, 102, 2, 1, 2, 3, 2],  # IF 2 앞 + 좌앞우앞 - 10개
    299: [5, 102, 2, 3, 2, 1, 2],  # IF 2 앞 + 우앞좌앞 - 10개
})

# ===== Tier 3: 고급 패턴 (300-399) =====
# 복잡한 조합

FUNCTION_LIBRARY.update({
    300: [2, 2, 1, 2, 2],     # 앞2+좌+앞2
    301: [2, 2, 3, 2, 2],     # 앞2+우+앞2
    302: [1, 2, 2, 1, 2],     # 좌+앞2+좌+앞
    303: [3, 2, 2, 3, 2],     # 우+앞2+우+앞
    304: [2, 1, 1, 2],        # 앞+좌2+앞
    305: [2, 3, 3, 2],        # 앞+우2+앞
    306: [1, 2, 1, 2, 1],     # 좌+앞+좌+앞+좌
    307: [3, 2, 3, 2, 3],     # 우+앞+우+앞+우
    308: [2, 2, 2, 1, 2],     # 앞3+좌+앞
    309: [2, 2, 2, 3, 2],     # 앞3+우+앞
    310: [1, 2, 2, 2],        # 좌+앞3
    311: [3, 2, 2, 2],        # 우+앞3
    312: [2, 1, 2, 2, 2],     # 앞+좌+앞3
    313: [2, 3, 2, 2, 2],     # 앞+우+앞3
    314: [1, 1, 2, 2, 2],     # 좌2+앞3
    315: [3, 3, 2, 2, 2],     # 우2+앞3
    316: [2, 2, 1, 1, 2],     # 앞2+좌2+앞
    317: [2, 2, 3, 3, 2],     # 앞2+우2+앞
    318: [1, 2, 3, 2],        # 좌+앞+우+앞
    319: [3, 2, 1, 2],        # 우+앞+좌+앞
    320: [2, 1, 2, 3, 2],     # 앞+좌+앞+우+앞
})

# 벽 탐색 패턴 (321-340) - 좌우 벽 따라가기
FUNCTION_LIBRARY.update({
    321: [2, 1, 2, 1, 2, 1],     # 좌측 벽 따라가기 (앞좌앞좌앞좌) - 6개
    322: [2, 3, 2, 3, 2, 3],     # 우측 벽 따라가기 (앞우앞우앞우) - 6개
    323: [2, 2, 1, 2, 2, 1],     # 앞2좌앞2좌 (넓은 좌측) - 6개
    324: [2, 2, 3, 2, 2, 3],     # 앞2우앞2우 (넓은 우측) - 6개
    325: [1, 2, 1, 2, 1, 2, 1],  # 좌앞 반복 (대각선 근사) - 7개
    326: [3, 2, 3, 2, 3, 2, 3],  # 우앞 반복 (대각선 근사) - 7개
    327: [2, 1, 2, 2, 1, 2, 2],  # 앞좌앞2좌앞2 (나선) - 7개
    328: [2, 3, 2, 2, 3, 2, 2],  # 앞우앞2우앞2 (나선) - 7개
    329: [2, 2, 2, 1, 2, 2],     # 앞3좌앞2 (L자) - 6개
    330: [2, 2, 2, 3, 2, 2],     # 앞3우앞2 (L자) - 6개
})

# U턴 & 백트래킹 패턴 (331-340)
FUNCTION_LIBRARY.update({
    331: [2, 2, 1, 1, 2, 2],     # 앞2좌2앞2 (U턴) - 6개
    332: [2, 2, 3, 3, 2, 2],     # 앞2우2앞2 (U턴) - 6개
    333: [2, 2, 2, 0, 2, 2],     # 앞3뒤앞2 (백트래킹) - 6개
    334: [2, 2, 0, 1, 2, 2],     # 앞2뒤좌앞2 - 6개
    335: [2, 2, 0, 3, 2, 2],     # 앞2뒤우앞2 - 6개
    336: [2, 0, 1, 2, 2, 2],     # 앞뒤좌앞3 - 6개
    337: [2, 0, 3, 2, 2, 2],     # 앞뒤우앞3 - 6개
    338: [2, 1, 0, 2, 3, 2],     # 앞좌뒤앞우앞 (회피) - 6개
    339: [2, 3, 0, 2, 1, 2],     # 앞우뒤앞좌앞 (회피) - 6개
    340: [2, 2, 1, 0, 2, 2],     # 앞2좌뒤앞2 - 6개
})

# 사각형 순회 패턴 (341-349)
FUNCTION_LIBRARY.update({
    341: [2, 2, 1, 2, 2, 1, 2, 2],  # 사각형 (앞2좌앞2좌앞2) - 8개
    342: [2, 2, 3, 2, 2, 3, 2, 2],  # 사각형 (앞2우앞2우앞2) - 8개
    343: [2, 1, 2, 1, 2, 1, 2],     # 계단 (앞좌앞좌앞좌앞) - 7개
    344: [2, 3, 2, 3, 2, 3, 2],     # 계단 (앞우앞우앞우앞) - 7개
    345: [2, 2, 2, 1, 2, 2, 2],     # 앞3좌앞3 (긴 L) - 7개
    346: [2, 2, 2, 3, 2, 2, 2],     # 앞3우앞3 (긴 L) - 7개
    347: [1, 2, 2, 1, 2, 2, 1],     # 좌앞2좌앞2좌 (나선) - 7개
    348: [3, 2, 2, 3, 2, 2, 3],     # 우앞2우앞2우 (나선) - 7개
    349: [2, 1, 2, 3, 2, 1, 2, 3],  # 지그재그 (앞좌앞우앞좌앞우) - 8개
})

# LOOP + 복잡한 패턴 (350-365)
FUNCTION_LIBRARY.update({
    350: [110, 102, 2, 1, 2], # LOOP (앞+좌+앞) 2번
    351: [110, 102, 2, 3, 2], # LOOP (앞+우+앞) 2번
    352: [110, 102, 1, 2, 1], # LOOP (좌+앞+좌) 2번
    353: [110, 102, 3, 2, 3], # LOOP (우+앞+우) 2번
    354: [110, 103, 2, 1, 2], # LOOP (앞+좌+앞) 3번
    355: [110, 103, 2, 3, 2], # LOOP (앞+우+앞) 3번
    356: [110, 104, 2, 1, 2], # LOOP (앞+좌+앞) 4번 - 9개
    357: [110, 104, 2, 3, 2], # LOOP (앞+우+앞) 4번 - 9개
    358: [110, 102, 2, 2, 1], # LOOP (앞2+좌) 2번 - 8개
    359: [110, 102, 2, 2, 3], # LOOP (앞2+우) 2번 - 8개
    360: [110, 103, 1, 2, 2], # LOOP (좌+앞2) 3번 - 9개
    361: [110, 103, 3, 2, 2], # LOOP (우+앞2) 3번 - 9개
    362: [110, 102, 1, 1, 2], # LOOP (좌2+앞) 2번 - 8개
    363: [110, 102, 3, 3, 2], # LOOP (우2+앞) 2번 - 8개
    364: [110, 104, 1, 2],    # LOOP (좌+앞) 4번 - 7개
    365: [110, 104, 3, 2],    # LOOP (우+앞) 4번 - 7개
})

# IF 고급 패턴 (366-380)
FUNCTION_LIBRARY.update({
    366: [5, 103, 2, 1, 2, 1, 2],  # IF 3 앞 + 좌앞좌앞 - 10개
    367: [5, 103, 2, 3, 2, 3, 2],  # IF 3 앞 + 우앞우앞 - 10개
    368: [5, 104, 2, 1, 2, 2],     # IF 4 앞 + 좌앞2 - 9개
    369: [5, 104, 2, 3, 2, 2],     # IF 4 앞 + 우앞2 - 9개
    370: [5, 102, 2, 1, 2, 3, 2],  # IF 2 앞 + 좌앞우앞 - 10개
    371: [5, 102, 2, 3, 2, 1, 2],  # IF 2 앞 + 우앞좌앞 - 10개
    372: [5, 103, 1, 2, 1, 2],     # IF 3 (좌앞좌앞) - 9개
    373: [5, 103, 3, 2, 3, 2],     # IF 3 (우앞우앞) - 9개
    374: [5, 104, 1, 2, 2, 2],     # IF 4 (좌앞3) - 9개
    375: [5, 104, 3, 2, 2, 2],     # IF 4 (우앞3) - 9개
    376: [5, 105, 2, 1, 2, 3],     # IF 5 앞 + 좌앞우 - 9개
    377: [5, 105, 2, 3, 2, 1],     # IF 5 앞 + 우앞좌 - 9개
    378: [5, 106, 2, 2, 1],        # IF 6 앞 + 앞2좌 - 8개
    379: [5, 106, 2, 2, 3],        # IF 6 앞 + 앞2우 - 8개
    380: [5, 102, 1, 2, 1, 2, 1],  # IF 2 (좌앞좌앞좌) - 10개
})

# 혼합 복잡 패턴 (381-399)
FUNCTION_LIBRARY.update({
    381: [2, 1, 2, 1, 2, 3, 2, 3],  # 앞좌앞좌앞우앞우 (십자) - 8개
    382: [2, 3, 2, 3, 2, 1, 2, 1],  # 앞우앞우앞좌앞좌 (십자) - 8개
    383: [2, 2, 1, 2, 3, 2, 2],     # 앞2좌앞우앞2 - 7개
    384: [2, 2, 3, 2, 1, 2, 2],     # 앞2우앞좌앞2 - 7개
    385: [1, 2, 2, 3, 2, 2, 1],     # 좌앞2우앞2좌 (S자) - 7개
    386: [3, 2, 2, 1, 2, 2, 3],     # 우앞2좌앞2우 (S자) - 7개
    387: [2, 1, 2, 2, 3, 2, 2],     # 앞좌앞2우앞2 - 7개
    388: [2, 3, 2, 2, 1, 2, 2],     # 앞우앞2좌앞2 - 7개
    389: [2, 2, 1, 1, 2, 3, 3],     # 앞2좌2앞우2 - 7개
    390: [2, 2, 3, 3, 2, 1, 1],     # 앞2우2앞좌2 - 7개
    391: [1, 1, 2, 2, 1, 2],        # 좌2앞2좌앞 - 6개
    392: [3, 3, 2, 2, 3, 2],        # 우2앞2우앞 - 6개
    393: [2, 1, 1, 2, 3, 2],        # 앞좌2앞우앞 - 6개
    394: [2, 3, 3, 2, 1, 2],        # 앞우2앞좌앞 - 6개
    395: [1, 2, 3, 3, 2, 2],        # 좌앞우2앞2 - 6개
    396: [3, 2, 1, 1, 2, 2],        # 우앞좌2앞2 - 6개
    397: [2, 0, 2, 1, 2, 3],        # 앞뒤앞좌앞우 (복잡 회피) - 6개
    398: [2, 0, 2, 3, 2, 1],        # 앞뒤앞우앞좌 (복잡 회피) - 6개
    399: [1, 2, 0, 3, 2, 2],        # 좌앞뒤우앞2 (회피) - 6개
})

# ===== Tier 4: 매우 고급 패턴 (400-599) =====
# 5개 이상 명령어 조합

FUNCTION_LIBRARY.update({
    400: [2, 2, 2, 2, 1, 2],     # 앞4+좌+앞
    401: [2, 2, 2, 2, 3, 2],     # 앞4+우+앞
    402: [1, 2, 2, 2, 1, 2],     # 좌+앞3+좌+앞
    403: [3, 2, 2, 2, 3, 2],     # 우+앞3+우+앞
    404: [2, 1, 2, 1, 2, 1],     # (앞+좌) 3회
    405: [2, 3, 2, 3, 2, 3],     # (앞+우) 3회
    406: [1, 1, 2, 2, 1, 1, 2],  # 좌2+앞2+좌2+앞
    407: [3, 3, 2, 2, 3, 3, 2],  # 우2+앞2+우2+앞
})

# 긴 나선형 패턴 (408-425) - 8-10개 토큰
FUNCTION_LIBRARY.update({
    408: [2, 1, 2, 2, 1, 2, 2, 2, 1, 2],  # 나선 확장 (앞좌앞2좌앞3좌앞) - 10개
    409: [2, 3, 2, 2, 3, 2, 2, 2, 3, 2],  # 나선 확장 (앞우앞2우앞3우앞) - 10개
    410: [1, 2, 1, 2, 2, 1, 2, 2, 2, 1],  # 좌앞좌앞2좌앞3좌 - 10개
    411: [3, 2, 3, 2, 2, 3, 2, 2, 2, 3],  # 우앞우앞2우앞3우 - 10개
    412: [2, 2, 1, 2, 2, 1, 2, 2, 1, 2],  # 앞2좌앞2좌앞2좌앞 - 10개
    413: [2, 2, 3, 2, 2, 3, 2, 2, 3, 2],  # 앞2우앞2우앞2우앞 - 10개
    414: [1, 2, 2, 1, 2, 2, 1, 2, 2],     # 좌앞2좌앞2좌앞2 - 9개
    415: [3, 2, 2, 3, 2, 2, 3, 2, 2],     # 우앞2우앞2우앞2 - 9개
    416: [2, 1, 2, 1, 2, 1, 2, 1, 2],     # 앞좌 5회 반복 - 9개
    417: [2, 3, 2, 3, 2, 3, 2, 3, 2],     # 앞우 5회 반복 - 9개
    418: [2, 2, 2, 1, 2, 2, 2, 1, 2],     # 앞3좌앞3좌앞 - 9개
    419: [2, 2, 2, 3, 2, 2, 2, 3, 2],     # 앞3우앞3우앞 - 9개
    420: [1, 2, 2, 2, 1, 2, 2, 2, 1],     # 좌앞3좌앞3좌 - 9개
    421: [3, 2, 2, 2, 3, 2, 2, 2, 3],     # 우앞3우앞3우 - 9개
    422: [2, 1, 1, 2, 2, 3, 3, 2, 2],     # 앞좌2앞2우2앞2 - 9개
    423: [2, 3, 3, 2, 2, 1, 1, 2, 2],     # 앞우2앞2좌2앞2 - 9개
    424: [1, 1, 2, 2, 2, 3, 3, 2, 2],     # 좌2앞3우2앞2 - 9개
    425: [3, 3, 2, 2, 2, 1, 1, 2, 2],     # 우2앞3좌2앞2 - 9개
})

# 복잡한 회피 & 탐색 (426-445) - 8-10개 토큰
FUNCTION_LIBRARY.update({
    426: [2, 2, 1, 2, 3, 2, 2, 1, 2, 3],  # 앞2좌앞우앞2좌앞우 - 10개
    427: [2, 2, 3, 2, 1, 2, 2, 3, 2, 1],  # 앞2우앞좌앞2우앞좌 - 10개
    428: [2, 1, 2, 3, 2, 1, 2, 3, 2],     # 앞좌앞우앞좌앞우앞 - 9개
    429: [2, 3, 2, 1, 2, 3, 2, 1, 2],     # 앞우앞좌앞우앞좌앞 - 9개
    430: [2, 2, 0, 2, 1, 2, 3, 2],        # 앞2뒤앞좌앞우앞 - 8개
    431: [2, 2, 0, 2, 3, 2, 1, 2],        # 앞2뒤앞우앞좌앞 - 8개
    432: [2, 1, 0, 2, 2, 3, 2, 2],        # 앞좌뒤앞2우앞2 - 8개
    433: [2, 3, 0, 2, 2, 1, 2, 2],        # 앞우뒤앞2좌앞2 - 8개
    434: [2, 0, 1, 2, 2, 0, 3, 2],        # 앞뒤좌앞2뒤우앞 - 8개
    435: [2, 0, 3, 2, 2, 0, 1, 2],        # 앞뒤우앞2뒤좌앞 - 8개
    436: [1, 2, 1, 2, 3, 2, 3, 2],        # 좌앞좌앞우앞우앞 - 8개
    437: [3, 2, 3, 2, 1, 2, 1, 2],        # 우앞우앞좌앞좌앞 - 8개
    438: [2, 1, 2, 2, 3, 2, 2, 1],        # 앞좌앞2우앞2좌 - 8개
    439: [2, 3, 2, 2, 1, 2, 2, 3],        # 앞우앞2좌앞2우 - 8개
    440: [1, 2, 2, 1, 2, 3, 2, 3],        # 좌앞2좌앞우앞우 - 8개
    441: [3, 2, 2, 3, 2, 1, 2, 1],        # 우앞2우앞좌앞좌 - 8개
    442: [2, 2, 1, 1, 2, 2, 3, 3],        # 앞2좌2앞2우2 - 8개
    443: [2, 2, 3, 3, 2, 2, 1, 1],        # 앞2우2앞2좌2 - 8개
    444: [1, 1, 2, 2, 3, 3, 2, 2],        # 좌2앞2우2앞2 - 8개
    445: [3, 3, 2, 2, 1, 1, 2, 2],        # 우2앞2좌2앞2 - 8개
})

# 사각형 & 순회 패턴 (446-449, 454-475) - 7-10개 토큰
FUNCTION_LIBRARY.update({
    446: [2, 2, 1, 2, 2, 1, 2, 2, 1],     # 사각형 순회 (앞2좌)x3 - 9개
    447: [2, 2, 3, 2, 2, 3, 2, 2, 3],     # 사각형 순회 (앞2우)x3 - 9개
    448: [2, 1, 2, 1, 2, 1, 2, 1],        # 계단 패턴 (앞좌)x4 - 8개
    449: [2, 3, 2, 3, 2, 3, 2, 3],        # 계단 패턴 (앞우)x4 - 8개
})

# LOOP + 매우 복잡한 패턴 (450-475)
FUNCTION_LIBRARY.update({
    450: [110, 102, 2, 2, 1, 2], # LOOP (앞2+좌+앞) 2번
    451: [110, 102, 2, 2, 3, 2], # LOOP (앞2+우+앞) 2번
    452: [110, 103, 1, 2, 1, 2], # LOOP (좌+앞+좌+앞) 3번
    453: [110, 103, 3, 2, 3, 2], # LOOP (우+앞+우+앞) 3번
    454: [110, 104, 2, 2, 1, 2], # LOOP (앞2+좌+앞) 4번 - 10개
    455: [110, 104, 2, 2, 3, 2], # LOOP (앞2+우+앞) 4번 - 10개
    456: [110, 102, 2, 1, 2, 3, 2], # LOOP (앞+좌+앞+우+앞) 2번 - 10개
    457: [110, 102, 2, 3, 2, 1, 2], # LOOP (앞+우+앞+좌+앞) 2번 - 10개
    458: [110, 103, 1, 1, 2, 2], # LOOP (좌2+앞2) 3번 - 9개
    459: [110, 103, 3, 3, 2, 2], # LOOP (우2+앞2) 3번 - 9개
    460: [110, 102, 2, 1, 2, 1, 2], # LOOP (앞+좌+앞+좌+앞) 2번 - 10개
    461: [110, 102, 2, 3, 2, 3, 2], # LOOP (앞+우+앞+우+앞) 2번 - 10개
    462: [110, 103, 2, 2, 1], # LOOP (앞2+좌) 3번 - 8개
    463: [110, 103, 2, 2, 3], # LOOP (앞2+우) 3번 - 8개
    464: [110, 104, 1, 2, 1], # LOOP (좌+앞+좌) 4번 - 8개
    465: [110, 104, 3, 2, 3], # LOOP (우+앞+우) 4번 - 8개
    466: [110, 105, 2, 1], # LOOP (앞+좌) 5번 - 7개
    467: [110, 105, 2, 3], # LOOP (앞+우) 5번 - 7개
    468: [110, 105, 1, 2], # LOOP (좌+앞) 5번 - 7개
    469: [110, 105, 3, 2], # LOOP (우+앞) 5번 - 7개
    470: [110, 106, 2, 1], # LOOP (앞+좌) 6번 - 7개
    471: [110, 106, 2, 3], # LOOP (앞+우) 6번 - 7개
    472: [110, 106, 1, 2], # LOOP (좌+앞) 6번 - 7개
    473: [110, 106, 3, 2], # LOOP (우+앞) 6번 - 7개
    474: [110, 107, 2, 1], # LOOP (앞+좌) 7번 - 7개
    475: [110, 107, 2, 3], # LOOP (앞+우) 7번 - 7개
})

# LOOP + IF 고급 조합 (476-520)
FUNCTION_LIBRARY.update({
    476: [110, 102, 2, 5, 103, 1],  # LOOP 2 앞 + IF 3 좌 - 9개
    477: [110, 102, 2, 5, 103, 3],  # LOOP 2 앞 + IF 3 우 - 9개
    478: [110, 103, 2, 5, 102, 1],  # LOOP 3 앞 + IF 2 좌 - 9개
    479: [110, 103, 2, 5, 102, 3],  # LOOP 3 앞 + IF 2 우 - 9개
    480: [5, 102, 2, 110, 103, 1],  # IF 2 앞 + LOOP 3 좌 - 9개
    481: [5, 102, 2, 110, 103, 3],  # IF 2 앞 + LOOP 3 우 - 9개
    482: [5, 103, 2, 110, 102, 1],  # IF 3 앞 + LOOP 2 좌 - 9개
    483: [5, 103, 2, 110, 102, 3],  # IF 3 앞 + LOOP 2 우 - 9개
    484: [110, 104, 2, 5, 103, 2],  # LOOP 4 앞 + IF 3 앞 - 9개
    485: [110, 105, 2, 5, 102, 2],  # LOOP 5 앞 + IF 2 앞 - 9개
    486: [5, 104, 2, 110, 103, 2],  # IF 4 앞 + LOOP 3 앞 - 9개
    487: [5, 105, 2, 110, 102, 2],  # IF 5 앞 + LOOP 2 앞 - 9개
    488: [110, 102, 1, 5, 103, 2],  # LOOP 2 좌 + IF 3 앞 - 9개
    489: [110, 102, 3, 5, 103, 2],  # LOOP 2 우 + IF 3 앞 - 9개
    490: [110, 103, 1, 5, 102, 2],  # LOOP 3 좌 + IF 2 앞 - 9개
    491: [110, 103, 3, 5, 102, 2],  # LOOP 3 우 + IF 2 앞 - 9개
    492: [5, 102, 1, 110, 103, 2],  # IF 2 좌 + LOOP 3 앞 - 9개
    493: [5, 102, 3, 110, 103, 2],  # IF 2 우 + LOOP 3 앞 - 9개
    494: [5, 103, 1, 110, 102, 2],  # IF 3 좌 + LOOP 2 앞 - 9개
    495: [5, 103, 3, 110, 102, 2],  # IF 3 우 + LOOP 2 앞 - 9개
    496: [110, 104, 1, 5, 102, 2],  # LOOP 4 좌 + IF 2 앞 - 9개
    497: [110, 104, 3, 5, 102, 2],  # LOOP 4 우 + IF 2 앞 - 9개
    498: [5, 104, 1, 110, 102, 2],  # IF 4 좌 + LOOP 2 앞 - 9개
    499: [5, 104, 3, 110, 102, 2],  # IF 4 우 + LOOP 2 앞 - 9개
    500: [110, 102, 2, 1, 5, 102, 2],  # LOOP 2 (앞좌) + IF 2 앞 - 10개
    501: [110, 102, 2, 3, 5, 102, 2],  # LOOP 2 (앞우) + IF 2 앞 - 10개
    502: [110, 103, 1, 2, 5, 102, 2],  # LOOP 3 (좌앞) + IF 2 앞 - 10개
    503: [110, 103, 3, 2, 5, 102, 2],  # LOOP 3 (우앞) + IF 2 앞 - 10개
    504: [5, 102, 2, 110, 102, 1, 2],  # IF 2 앞 + LOOP 2 (좌앞) - 10개
    505: [5, 102, 2, 110, 102, 3, 2],  # IF 2 앞 + LOOP 2 (우앞) - 10개
    506: [5, 103, 2, 110, 103, 1, 2],  # IF 3 앞 + LOOP 3 (좌앞) - 10개
    507: [5, 103, 2, 110, 103, 3, 2],  # IF 3 앞 + LOOP 3 (우앞) - 10개
    508: [110, 102, 1, 2, 5, 103, 2],  # LOOP 2 (좌앞) + IF 3 앞 - 10개
    509: [110, 102, 3, 2, 5, 103, 2],  # LOOP 2 (우앞) + IF 3 앞 - 10개
    510: [5, 102, 1, 2, 110, 103, 2],  # IF 2 (좌앞) + LOOP 3 앞 - 10개
    511: [5, 102, 3, 2, 110, 103, 2],  # IF 2 (우앞) + LOOP 3 앞 - 10개
    512: [110, 104, 2, 1, 5, 102, 2],  # LOOP 4 (앞좌) + IF 2 앞 - 10개
    513: [110, 104, 2, 3, 5, 102, 2],  # LOOP 4 (앞우) + IF 2 앞 - 10개
    514: [5, 104, 2, 110, 102, 1, 2],  # IF 4 앞 + LOOP 2 (좌앞) - 10개
    515: [5, 104, 2, 110, 102, 3, 2],  # IF 4 앞 + LOOP 2 (우앞) - 10개
    516: [110, 105, 2, 1, 5, 102, 1],  # LOOP 5 (앞좌) + IF 2 좌 - 10개
    517: [110, 105, 2, 3, 5, 102, 3],  # LOOP 5 (앞우) + IF 2 우 - 10개
    518: [5, 105, 2, 110, 102, 1, 2],  # IF 5 앞 + LOOP 2 (좌앞) - 10개
    519: [5, 105, 2, 110, 102, 3, 2],  # IF 5 앞 + LOOP 2 (우앞) - 10개
    520: [110, 106, 2, 5, 102, 2],     # LOOP 6 앞 + IF 2 앞 - 9개
})

# 매우 복잡한 혼합 패턴 (521-599) - 7-10개 토큰
FUNCTION_LIBRARY.update({
    521: [2, 1, 2, 1, 2, 1, 2, 1, 2, 1],  # (앞좌)x5 - 10개
    522: [2, 3, 2, 3, 2, 3, 2, 3, 2, 3],  # (앞우)x5 - 10개
    523: [1, 2, 1, 2, 1, 2, 1, 2, 1, 2],  # (좌앞)x5 - 10개
    524: [3, 2, 3, 2, 3, 2, 3, 2, 3, 2],  # (우앞)x5 - 10개
    525: [2, 2, 1, 2, 2, 1, 2, 2, 1, 2],  # (앞2좌)x3 + 앞 - 10개
    526: [2, 2, 3, 2, 2, 3, 2, 2, 3, 2],  # (앞2우)x3 + 앞 - 10개
    527: [1, 2, 2, 1, 2, 2, 1, 2, 2, 1],  # (좌앞2)x3 + 좌 - 10개
    528: [3, 2, 2, 3, 2, 2, 3, 2, 2, 3],  # (우앞2)x3 + 우 - 10개
    529: [2, 1, 2, 3, 2, 1, 2, 3, 2, 1],  # 지그재그 확장 - 10개
    530: [2, 3, 2, 1, 2, 3, 2, 1, 2, 3],  # 지그재그 확장 - 10개
    531: [2, 2, 2, 1, 2, 2, 2, 3, 2, 2],  # 앞3좌앞3우앞2 - 10개
    532: [2, 2, 2, 3, 2, 2, 2, 1, 2, 2],  # 앞3우앞3좌앞2 - 10개
    533: [1, 1, 2, 2, 2, 3, 3, 2, 2, 2],  # 좌2앞3우2앞3 - 10개
    534: [3, 3, 2, 2, 2, 1, 1, 2, 2, 2],  # 우2앞3좌2앞3 - 10개
    535: [2, 1, 1, 2, 2, 3, 3, 2, 2, 1],  # 앞좌2앞2우2앞2좌 - 10개
    536: [2, 3, 3, 2, 2, 1, 1, 2, 2, 3],  # 앞우2앞2좌2앞2우 - 10개
    537: [2, 0, 2, 1, 2, 0, 2, 3, 2],     # 앞뒤앞좌앞뒤앞우앞 - 9개
    538: [2, 0, 2, 3, 2, 0, 2, 1, 2],     # 앞뒤앞우앞뒤앞좌앞 - 9개
    539: [1, 2, 0, 2, 3, 2, 0, 2, 1],     # 좌앞뒤앞우앞뒤앞좌 - 9개
    540: [3, 2, 0, 2, 1, 2, 0, 2, 3],     # 우앞뒤앞좌앞뒤앞우 - 9개
    541: [2, 1, 2, 2, 1, 2, 2, 1, 2],     # 앞좌앞2좌앞2좌앞 - 9개
    542: [2, 3, 2, 2, 3, 2, 2, 3, 2],     # 앞우앞2우앞2우앞 - 9개
    543: [1, 2, 2, 1, 2, 2, 1, 2, 2],     # (좌앞2)x3 - 9개
    544: [3, 2, 2, 3, 2, 2, 3, 2, 2],     # (우앞2)x3 - 9개
    545: [2, 2, 1, 2, 2, 3, 2, 2, 1],     # 앞2좌앞2우앞2좌 - 9개
    546: [2, 2, 3, 2, 2, 1, 2, 2, 3],     # 앞2우앞2좌앞2우 - 9개
    547: [1, 2, 1, 2, 1, 2, 1, 2],        # (좌앞)x4 - 8개
    548: [3, 2, 3, 2, 3, 2, 3, 2],        # (우앞)x4 - 8개
    549: [2, 1, 2, 1, 2, 1, 2, 1],        # (앞좌)x4 - 8개
    550: [2, 3, 2, 3, 2, 3, 2, 3],        # (앞우)x4 - 8개
    551: [2, 2, 1, 2, 2, 1, 2, 2],        # (앞2좌)x2 + 앞2 - 8개
    552: [2, 2, 3, 2, 2, 3, 2, 2],        # (앞2우)x2 + 앞2 - 8개
    553: [1, 2, 2, 1, 2, 2, 1, 2],        # (좌앞2)x2 + 좌앞 - 8개
    554: [3, 2, 2, 3, 2, 2, 3, 2],        # (우앞2)x2 + 우앞 - 8개
    555: [2, 1, 2, 3, 2, 1, 2, 3],        # (앞좌앞우)x2 - 8개
    556: [2, 3, 2, 1, 2, 3, 2, 1],        # (앞우앞좌)x2 - 8개
    557: [1, 2, 3, 2, 1, 2, 3, 2],        # (좌앞우앞)x2 - 8개
    558: [3, 2, 1, 2, 3, 2, 1, 2],        # (우앞좌앞)x2 - 8개
    559: [2, 2, 2, 1, 2, 2, 2, 1],        # (앞3좌)x2 - 8개
    560: [2, 2, 2, 3, 2, 2, 2, 3],        # (앞3우)x2 - 8개
    561: [1, 2, 2, 2, 1, 2, 2, 2],        # (좌앞3)x2 - 8개
    562: [3, 2, 2, 2, 3, 2, 2, 2],        # (우앞3)x2 - 8개
    563: [2, 1, 1, 2, 3, 3, 2, 2],        # 앞좌2앞우2앞2 - 8개
    564: [2, 3, 3, 2, 1, 1, 2, 2],        # 앞우2앞좌2앞2 - 8개
    565: [1, 1, 2, 2, 3, 3, 2],          # 좌2앞2우2앞 - 7개
    566: [3, 3, 2, 2, 1, 1, 2],          # 우2앞2좌2앞 - 7개
    567: [2, 1, 2, 2, 3, 2, 2],          # 앞좌앞2우앞2 - 7개
    568: [2, 3, 2, 2, 1, 2, 2],          # 앞우앞2좌앞2 - 7개
    569: [1, 2, 2, 3, 2, 2, 1],          # 좌앞2우앞2좌 - 7개
    570: [3, 2, 2, 1, 2, 2, 3],          # 우앞2좌앞2우 - 7개
    571: [2, 2, 1, 1, 2, 2, 2],          # 앞2좌2앞3 - 7개
    572: [2, 2, 3, 3, 2, 2, 2],          # 앞2우2앞3 - 7개
    573: [2, 0, 2, 1, 2, 3, 2],          # 앞뒤앞좌앞우앞 - 7개
    574: [2, 0, 2, 3, 2, 1, 2],          # 앞뒤앞우앞좌앞 - 7개
    575: [1, 2, 0, 2, 3, 2, 2],          # 좌앞뒤앞우앞2 - 7개
    576: [3, 2, 0, 2, 1, 2, 2],          # 우앞뒤앞좌앞2 - 7개
    577: [2, 1, 2, 1, 2, 1, 2],          # (앞좌)x3 + 앞 - 7개
    578: [2, 3, 2, 3, 2, 3, 2],          # (앞우)x3 + 앞 - 7개
    579: [1, 2, 1, 2, 1, 2, 1],          # (좌앞)x3 + 좌 - 7개
    580: [3, 2, 3, 2, 3, 2, 3],          # (우앞)x3 + 우 - 7개
    581: [2, 2, 1, 2, 2, 3, 2],          # 앞2좌앞2우앞 - 7개
    582: [2, 2, 3, 2, 2, 1, 2],          # 앞2우앞2좌앞 - 7개
    583: [1, 2, 2, 1, 2, 2],             # (좌앞2)x2 - 6개
    584: [3, 2, 2, 3, 2, 2],             # (우앞2)x2 - 6개
    585: [2, 1, 2, 3, 2, 1],             # 앞좌앞우앞좌 - 6개
    586: [2, 3, 2, 1, 2, 3],             # 앞우앞좌앞우 - 6개
    587: [1, 2, 3, 2, 1, 2],             # 좌앞우앞좌앞 - 6개
    588: [3, 2, 1, 2, 3, 2],             # 우앞좌앞우앞 - 6개
    589: [2, 2, 2, 1, 2, 2],             # 앞3좌앞2 - 6개
    590: [2, 2, 2, 3, 2, 2],             # 앞3우앞2 - 6개
    591: [1, 2, 2, 2, 1, 2],             # 좌앞3좌앞 - 6개
    592: [3, 2, 2, 2, 3, 2],             # 우앞3우앞 - 6개
    593: [2, 1, 1, 2, 2, 2],             # 앞좌2앞3 - 6개
    594: [2, 3, 3, 2, 2, 2],             # 앞우2앞3 - 6개
    595: [2, 0, 2, 1, 2],                # 앞뒤앞좌앞 - 5개
    596: [2, 0, 2, 3, 2],                # 앞뒤앞우앞 - 5개
    597: [1, 2, 0, 2, 1],                # 좌앞뒤앞좌 - 5개
    598: [3, 2, 0, 2, 3],                # 우앞뒤앞우 - 5개
    599: [2, 1, 2, 3, 2],                # 앞좌앞우앞 - 5개
})

# ===== Tier 5: 전문가 패턴 (600-798) =====
# 최고급 패턴 - 11x11 미로 네비게이션 최적화 (8-10 토큰)
FUNCTION_LIBRARY.update({
    # 장거리 직선 이동 (600-619) - 그리드 횡단용
    600: [2, 2, 2, 2, 2, 2, 2, 2, 2, 2],  # 앞 10칸 (그리드 거의 횡단)
    601: [2, 2, 2, 2, 2, 2, 2, 2, 2],     # 앞 9칸
    602: [2, 2, 2, 2, 2, 2, 2, 2],        # 앞 8칸
    603: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],  # 좌 10칸
    604: [3, 3, 3, 3, 3, 3, 3, 3, 3, 3],  # 우 10칸
    605: [2, 2, 2, 2, 2, 2, 2],           # 앞 7칸
    606: [1, 1, 1, 1, 1, 1, 1, 1],        # 좌 8칸
    607: [3, 3, 3, 3, 3, 3, 3, 3],        # 우 8칸
    608: [2, 1, 2, 1, 2, 1, 2, 1, 2, 1],  # (앞좌)x5 - 대각선 장거리
    609: [2, 3, 2, 3, 2, 3, 2, 3, 2, 3],  # (앞우)x5 - 대각선 장거리
    610: [1, 2, 1, 2, 1, 2, 1, 2, 1, 2],  # (좌앞)x5
    611: [3, 2, 3, 2, 3, 2, 3, 2, 3, 2],  # (우앞)x5
    612: [2, 2, 1, 2, 2, 1, 2, 2, 1, 2],  # (앞2좌)x3 + 앞
    613: [2, 2, 3, 2, 2, 3, 2, 2, 3, 2],  # (앞2우)x3 + 앞
    614: [1, 2, 2, 1, 2, 2, 1, 2, 2],     # (좌앞2)x3
    615: [3, 2, 2, 3, 2, 2, 3, 2, 2],     # (우앞2)x3
    616: [2, 2, 2, 1, 2, 2, 2, 3],        # 앞3좌앞3우 - L자
    617: [2, 2, 2, 3, 2, 2, 2, 1],        # 앞3우앞3좌 - 역L자
    618: [1, 2, 2, 2, 3, 2, 2, 2],        # 좌앞3우앞3
    619: [3, 2, 2, 2, 1, 2, 2, 2],        # 우앞3좌앞3

    # 그리드 스위핑 패턴 (620-649) - 체계적 탐색
    620: [2, 2, 1, 2, 2, 1, 2, 2, 1, 2],  # 좌측 지그재그 스캔
    621: [2, 2, 3, 2, 2, 3, 2, 2, 3, 2],  # 우측 지그재그 스캔
    622: [2, 1, 2, 2, 1, 2, 2, 1, 2, 2],  # 계단식 좌측
    623: [2, 3, 2, 2, 3, 2, 2, 3, 2, 2],  # 계단식 우측
    624: [1, 2, 1, 2, 2, 1, 2, 1, 2, 2],  # 불규칙 좌측 탐색
    625: [3, 2, 3, 2, 2, 3, 2, 3, 2, 2],  # 불규칙 우측 탐색
    626: [2, 1, 1, 2, 2, 1, 1, 2, 2],     # (앞좌좌앞2)x2
    627: [2, 3, 3, 2, 2, 3, 3, 2, 2],     # (앞우우앞2)x2
    628: [1, 1, 2, 2, 1, 1, 2, 2],        # (좌좌앞2)x2
    629: [3, 3, 2, 2, 3, 3, 2, 2],        # (우우앞2)x2
    630: [2, 2, 1, 1, 2, 2, 1, 1, 2],     # (앞2좌좌)x2 + 앞
    631: [2, 2, 3, 3, 2, 2, 3, 3, 2],     # (앞2우우)x2 + 앞
    632: [2, 1, 2, 2, 1, 2, 2, 1, 2],     # 좌측 벽 따라 긴 경로
    633: [2, 3, 2, 2, 3, 2, 2, 3, 2],     # 우측 벽 따라 긴 경로
    634: [1, 2, 2, 1, 2, 2, 1, 2],        # (좌앞2)x2 + 좌앞
    635: [3, 2, 2, 3, 2, 2, 3, 2],        # (우앞2)x2 + 우앞
    636: [2, 2, 2, 1, 1, 2, 2, 2],        # 앞3좌2앞3 - 넓은 U턴
    637: [2, 2, 2, 3, 3, 2, 2, 2],        # 앞3우2앞3
    638: [1, 1, 2, 2, 2, 3, 3, 2],        # 좌2앞3우2앞
    639: [3, 3, 2, 2, 2, 1, 1, 2],        # 우2앞3좌2앞
    640: [2, 1, 2, 1, 2, 1, 2],           # 좌측 지그재그 7칸
    641: [2, 3, 2, 3, 2, 3, 2],           # 우측 지그재그 7칸
    642: [1, 2, 1, 2, 1, 2, 1, 2],        # (좌앞)x4
    643: [3, 2, 3, 2, 3, 2, 3, 2],        # (우앞)x4
    644: [2, 2, 1, 2, 2, 3, 2, 2],        # 앞2좌앞2우앞2 - S자
    645: [2, 2, 3, 2, 2, 1, 2, 2],        # 앞2우앞2좌앞2 - 역S자
    646: [1, 2, 2, 1, 2, 2, 1],           # (좌앞2)x2 + 좌
    647: [3, 2, 2, 3, 2, 2, 3],           # (우앞2)x2 + 우
    648: [2, 1, 1, 2, 3, 3, 2],           # 앞좌2앞우2앞 - 나비
    649: [2, 3, 3, 2, 1, 1, 2],           # 앞우2앞좌2앞 - 역나비

    # 복잡한 LOOP 패턴 (650-699) - 고급 제어 흐름
    650: [110, 109, 2, 1, 2, 3, 2, 1, 2],     # LOOP 9 (앞좌앞우앞좌앞) - 10개
    651: [110, 109, 2, 3, 2, 1, 2, 3, 2],     # LOOP 9 (앞우앞좌앞우앞) - 10개
    652: [110, 108, 2, 2, 1, 2, 2, 3, 2],     # LOOP 8 (앞2좌앞2우앞) - 10개
    653: [110, 108, 2, 2, 3, 2, 2, 1, 2],     # LOOP 8 (앞2우앞2좌앞) - 10개
    654: [110, 107, 2, 1, 2, 1, 2, 1, 2],     # LOOP 7 (앞좌)x3 + 앞 - 10개
    655: [110, 107, 2, 3, 2, 3, 2, 3, 2],     # LOOP 7 (앞우)x3 + 앞 - 10개
    656: [110, 106, 2, 2, 1, 2, 2, 1, 2],     # LOOP 6 (앞2좌)x2 + 앞 - 10개
    657: [110, 106, 2, 2, 3, 2, 2, 3, 2],     # LOOP 6 (앞2우)x2 + 앞 - 10개
    658: [110, 105, 2, 1, 2, 3, 2],           # LOOP 5 (앞좌앞우앞) - 7개
    659: [110, 105, 2, 3, 2, 1, 2],           # LOOP 5 (앞우앞좌앞) - 7개
    660: [110, 104, 2, 2, 1, 2, 2],           # LOOP 4 (앞2좌앞2) - 7개
    661: [110, 104, 2, 2, 3, 2, 2],           # LOOP 4 (앞2우앞2) - 7개
    662: [110, 103, 2, 1, 2, 1, 2],           # LOOP 3 (앞좌)x2 + 앞 - 7개
    663: [110, 103, 2, 3, 2, 3, 2],           # LOOP 3 (앞우)x2 + 앞 - 7개
    664: [110, 102, 2, 1, 2],                 # LOOP 2 (앞좌앞) - 5개
    665: [110, 102, 2, 3, 2],                 # LOOP 2 (앞우앞) - 5개
    666: [110, 109, 1, 2, 1, 2, 1, 2, 1],     # LOOP 9 (좌앞)x4 - 10개
    667: [110, 109, 3, 2, 3, 2, 3, 2, 3],     # LOOP 9 (우앞)x4 - 10개
    668: [110, 108, 1, 2, 2, 1, 2, 2, 1],     # LOOP 8 (좌앞2)x2 + 좌 - 10개
    669: [110, 108, 3, 2, 2, 3, 2, 2, 3],     # LOOP 8 (우앞2)x2 + 우 - 10개
    670: [110, 107, 1, 2, 1, 2, 1, 2],        # LOOP 7 (좌앞)x3 - 9개
    671: [110, 107, 3, 2, 3, 2, 3, 2],        # LOOP 7 (우앞)x3 - 9개
    672: [110, 106, 1, 1, 2, 2, 1, 1, 2],     # LOOP 6 (좌좌앞2)x2 - 10개
    673: [110, 106, 3, 3, 2, 2, 3, 3, 2],     # LOOP 6 (우우앞2)x2 - 10개
    674: [110, 105, 2, 2, 1, 1, 2],           # LOOP 5 (앞2좌2앞) - 7개
    675: [110, 105, 2, 2, 3, 3, 2],           # LOOP 5 (앞2우2앞) - 7개
    676: [110, 104, 1, 2, 2, 1, 2],           # LOOP 4 (좌앞2)x2 - 7개
    677: [110, 104, 3, 2, 2, 3, 2],           # LOOP 4 (우앞2)x2 - 7개
    678: [110, 103, 1, 1, 2, 2],              # LOOP 3 (좌2앞2) - 6개
    679: [110, 103, 3, 3, 2, 2],              # LOOP 3 (우2앞2) - 6개
    680: [110, 109, 2, 2, 2, 1, 1],           # LOOP 9 (앞3좌2) - 7개
    681: [110, 109, 2, 2, 2, 3, 3],           # LOOP 9 (앞3우2) - 7개
    682: [110, 108, 1, 2, 2, 2, 1],           # LOOP 8 (좌앞3좌) - 7개
    683: [110, 108, 3, 2, 2, 2, 3],           # LOOP 8 (우앞3우) - 7개
    684: [110, 107, 2, 1, 2, 3],              # LOOP 7 (앞좌앞우) - 6개
    685: [110, 107, 2, 3, 2, 1],              # LOOP 7 (앞우앞좌) - 6개
    686: [110, 106, 1, 2, 3, 2],              # LOOP 6 (좌앞우앞) - 6개
    687: [110, 106, 3, 2, 1, 2],              # LOOP 6 (우앞좌앞) - 6개
    688: [110, 105, 2, 2, 2, 2],              # LOOP 5 (앞4) - 6개
    689: [110, 105, 1, 1, 1, 1],              # LOOP 5 (좌4) - 6개
    690: [110, 105, 3, 3, 3, 3],              # LOOP 5 (우4) - 6개
    691: [110, 104, 2, 1, 1, 2],              # LOOP 4 (앞좌2앞) - 6개
    692: [110, 104, 2, 3, 3, 2],              # LOOP 4 (앞우2앞) - 6개
    693: [110, 103, 2, 0, 2],                 # LOOP 3 (앞뒤앞) - 5개
    694: [110, 102, 1, 1],                    # LOOP 2 (좌2) - 4개
    695: [110, 102, 3, 3],                    # LOOP 2 (우2) - 4개
    696: [110, 109, 2, 2, 1, 2, 2, 3],        # LOOP 9 (앞2좌앞2우) - 9개
    697: [110, 109, 2, 2, 3, 2, 2, 1],        # LOOP 9 (앞2우앞2좌) - 9개
    698: [110, 108, 1, 2, 1, 2, 3, 2],        # LOOP 8 (좌앞좌앞우앞) - 9개
    699: [110, 108, 3, 2, 3, 2, 1, 2],        # LOOP 8 (우앞우앞좌앞) - 9개

    # 복잡한 IF 패턴 (700-729) - 조건부 네비게이션
    700: [5, 109, 2, 1, 2, 3, 2, 1, 2],       # IF 9 (앞좌앞우앞좌앞) - 10개
    701: [5, 109, 2, 3, 2, 1, 2, 3, 2],       # IF 9 (앞우앞좌앞우앞) - 10개
    702: [5, 108, 2, 2, 1, 2, 2, 3, 2],       # IF 8 (앞2좌앞2우앞) - 10개
    703: [5, 108, 2, 2, 3, 2, 2, 1, 2],       # IF 8 (앞2우앞2좌앞) - 10개
    704: [5, 107, 2, 1, 2, 1, 2, 1, 2],       # IF 7 (앞좌)x3 + 앞 - 10개
    705: [5, 107, 2, 3, 2, 3, 2, 3, 2],       # IF 7 (앞우)x3 + 앞 - 10개
    706: [5, 106, 2, 2, 1, 2, 2, 1, 2],       # IF 6 (앞2좌)x2 + 앞 - 10개
    707: [5, 106, 2, 2, 3, 2, 2, 3, 2],       # IF 6 (앞2우)x2 + 앞 - 10개
    708: [5, 105, 2, 1, 2, 3, 2],             # IF 5 (앞좌앞우앞) - 7개
    709: [5, 105, 2, 3, 2, 1, 2],             # IF 5 (앞우앞좌앞) - 7개
    710: [5, 104, 2, 2, 1, 2, 2],             # IF 4 (앞2좌앞2) - 7개
    711: [5, 104, 2, 2, 3, 2, 2],             # IF 4 (앞2우앞2) - 7개
    712: [5, 103, 2, 1, 2, 1, 2],             # IF 3 (앞좌)x2 + 앞 - 7개
    713: [5, 103, 2, 3, 2, 3, 2],             # IF 3 (앞우)x2 + 앞 - 7개
    714: [5, 102, 2, 1, 2],                   # IF 2 (앞좌앞) - 5개
    715: [5, 102, 2, 3, 2],                   # IF 2 (앞우앞) - 5개
    716: [5, 109, 1, 2, 1, 2, 1, 2, 1],       # IF 9 (좌앞)x4 - 10개
    717: [5, 109, 3, 2, 3, 2, 3, 2, 3],       # IF 9 (우앞)x4 - 10개
    718: [5, 108, 1, 2, 2, 1, 2, 2, 1],       # IF 8 (좌앞2)x2 + 좌 - 10개
    719: [5, 108, 3, 2, 2, 3, 2, 2, 3],       # IF 8 (우앞2)x2 + 우 - 10개
    720: [5, 107, 1, 2, 1, 2, 1, 2],          # IF 7 (좌앞)x3 - 9개
    721: [5, 107, 3, 2, 3, 2, 3, 2],          # IF 7 (우앞)x3 - 9개
    722: [5, 106, 1, 1, 2, 2, 1, 1, 2],       # IF 6 (좌좌앞2)x2 - 10개
    723: [5, 106, 3, 3, 2, 2, 3, 3, 2],       # IF 6 (우우앞2)x2 - 10개
    724: [5, 105, 2, 2, 1, 1, 2],             # IF 5 (앞2좌2앞) - 7개
    725: [5, 105, 2, 2, 3, 3, 2],             # IF 5 (앞2우2앞) - 7개
    726: [5, 104, 1, 2, 2, 1, 2],             # IF 4 (좌앞2)x2 - 7개
    727: [5, 104, 3, 2, 2, 3, 2],             # IF 4 (우앞2)x2 - 7개
    728: [5, 103, 1, 1, 2, 2],                # IF 3 (좌2앞2) - 6개
    729: [5, 103, 3, 3, 2, 2],                # IF 3 (우2앞2) - 6개

    # LOOP+IF 전문가 조합 (730-779) - 최대 복잡도
    730: [110, 105, 2, 5, 103, 1, 2, 1],      # LOOP 5 앞 + IF 3 (좌앞좌) - 10개
    731: [110, 105, 2, 5, 103, 3, 2, 3],      # LOOP 5 앞 + IF 3 (우앞우) - 10개
    732: [5, 105, 2, 110, 103, 1, 2, 1],      # IF 5 앞 + LOOP 3 (좌앞좌) - 10개
    733: [5, 105, 2, 110, 103, 3, 2, 3],      # IF 5 앞 + LOOP 3 (우앞우) - 10개
    734: [110, 104, 2, 5, 104, 2, 1],         # LOOP 4 앞 + IF 4 (앞좌) - 9개
    735: [110, 104, 2, 5, 104, 2, 3],         # LOOP 4 앞 + IF 4 (앞우) - 9개
    736: [5, 104, 2, 110, 104, 2, 1],         # IF 4 앞 + LOOP 4 (앞좌) - 9개
    737: [5, 104, 2, 110, 104, 2, 3],         # IF 4 앞 + LOOP 4 (앞우) - 9개
    738: [110, 103, 2, 5, 103, 2],            # LOOP 3 앞 + IF 3 앞 - 8개
    739: [5, 103, 2, 110, 103, 2],            # IF 3 앞 + LOOP 3 앞 - 8개
    740: [110, 102, 2, 5, 102, 2, 1, 2],      # LOOP 2 앞 + IF 2 (앞좌앞) - 10개
    741: [110, 102, 2, 5, 102, 2, 3, 2],      # LOOP 2 앞 + IF 2 (앞우앞) - 10개
    742: [5, 102, 2, 110, 102, 2, 1, 2],      # IF 2 앞 + LOOP 2 (앞좌앞) - 10개
    743: [5, 102, 2, 110, 102, 2, 3, 2],      # IF 2 앞 + LOOP 2 (앞우앞) - 10개
    744: [110, 105, 1, 5, 105, 2, 1],         # LOOP 5 좌 + IF 5 (앞좌) - 9개
    745: [110, 105, 3, 5, 105, 2, 3],         # LOOP 5 우 + IF 5 (앞우) - 9개
    746: [5, 105, 1, 110, 105, 2, 1],         # IF 5 좌 + LOOP 5 (앞좌) - 9개
    747: [5, 105, 3, 110, 105, 2, 3],         # IF 5 우 + LOOP 5 (앞우) - 9개
    748: [110, 104, 2, 1, 5, 104, 2],         # LOOP 4 (앞좌) + IF 4 앞 - 9개
    749: [110, 104, 2, 3, 5, 104, 2],         # LOOP 4 (앞우) + IF 4 앞 - 9개
    750: [5, 104, 2, 1, 110, 104, 2],         # IF 4 (앞좌) + LOOP 4 앞 - 9개
    751: [5, 104, 2, 3, 110, 104, 2],         # IF 4 (앞우) + LOOP 4 앞 - 9개
    752: [110, 103, 2, 1, 5, 103, 1],         # LOOP 3 (앞좌) + IF 3 좌 - 9개
    753: [110, 103, 2, 3, 5, 103, 3],         # LOOP 3 (앞우) + IF 3 우 - 9개
    754: [5, 103, 2, 1, 110, 103, 1],         # IF 3 (앞좌) + LOOP 3 좌 - 9개
    755: [5, 103, 2, 3, 110, 103, 3],         # IF 3 (앞우) + LOOP 3 우 - 9개
    756: [110, 102, 1, 5, 102, 1, 2, 1],      # LOOP 2 좌 + IF 2 (좌앞좌) - 10개
    757: [110, 102, 3, 5, 102, 3, 2, 3],      # LOOP 2 우 + IF 2 (우앞우) - 10개
    758: [5, 102, 1, 110, 102, 1, 2, 1],      # IF 2 좌 + LOOP 2 (좌앞좌) - 10개
    759: [5, 102, 3, 110, 102, 3, 2, 3],      # IF 2 우 + LOOP 2 (우앞우) - 10개
    760: [110, 106, 2, 5, 102, 1],            # LOOP 6 앞 + IF 2 좌 - 8개
    761: [110, 106, 2, 5, 102, 3],            # LOOP 6 앞 + IF 2 우 - 8개
    762: [5, 106, 2, 110, 102, 1],            # IF 6 앞 + LOOP 2 좌 - 8개
    763: [5, 106, 2, 110, 102, 3],            # IF 6 앞 + LOOP 2 우 - 8개
    764: [110, 107, 2, 5, 101, 1],            # LOOP 7 앞 + IF 1 좌 - 8개
    765: [110, 107, 2, 5, 101, 3],            # LOOP 7 앞 + IF 1 우 - 8개
    766: [5, 107, 2, 110, 101, 1],            # IF 7 앞 + LOOP 1 좌 - 8개
    767: [5, 107, 2, 110, 101, 3],            # IF 7 앞 + LOOP 1 우 - 8개
    768: [110, 108, 2, 5, 100, 1],            # LOOP 8 앞 + IF 0 좌 - 8개
    769: [110, 108, 2, 5, 100, 3],            # LOOP 8 앞 + IF 0 우 - 8개
    770: [5, 108, 2, 110, 100, 1],            # IF 8 앞 + LOOP 0 좌 - 8개
    771: [5, 108, 2, 110, 100, 3],            # IF 8 앞 + LOOP 0 우 - 8개
    772: [110, 103, 1, 5, 103, 3, 2],         # LOOP 3 좌 + IF 3 (우앞) - 9개
    773: [110, 103, 3, 5, 103, 1, 2],         # LOOP 3 우 + IF 3 (좌앞) - 9개
    774: [5, 103, 1, 110, 103, 3, 2],         # IF 3 좌 + LOOP 3 (우앞) - 9개
    775: [5, 103, 3, 110, 103, 1, 2],         # IF 3 우 + LOOP 3 (좌앞) - 9개
    776: [110, 104, 1, 2, 5, 104, 3],         # LOOP 4 (좌앞) + IF 4 우 - 9개
    777: [110, 104, 3, 2, 5, 104, 1],         # LOOP 4 (우앞) + IF 4 좌 - 9개
    778: [5, 104, 1, 2, 110, 104, 3],         # IF 4 (좌앞) + LOOP 4 우 - 9개
    779: [5, 104, 3, 2, 110, 104, 1],         # IF 4 (우앞) + LOOP 4 좌 - 9개

    # 긴급 회피 패턴 (780-798) - 빠른 탈출 경로
    780: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],      # 뒤로 10칸 (긴급 후퇴!)
    781: [0, 0, 0, 0, 0, 0, 0, 0, 0],         # 뒤로 9칸
    782: [0, 0, 0, 0, 0, 0, 0, 0],            # 뒤로 8칸
    783: [0, 0, 0, 0, 0, 0, 0],               # 뒤로 7칸
    784: [2, 0, 2, 0, 2, 0, 2, 0],            # (앞뒤)x4 - 신중한 전진
    785: [0, 1, 0, 1, 0, 1, 0, 1],            # (뒤좌)x4 - 후퇴+회피
    786: [0, 3, 0, 3, 0, 3, 0, 3],            # (뒤우)x4 - 후퇴+회피
    787: [1, 0, 1, 0, 1, 0, 1, 0],            # (좌뒤)x4 - 측면 후퇴
    788: [3, 0, 3, 0, 3, 0, 3, 0],            # (우뒤)x4 - 측면 후퇴
    789: [2, 0, 1, 0, 2, 0, 3, 0],            # 앞뒤좌뒤앞뒤우뒤 - 복잡 회피
    790: [0, 2, 0, 1, 2, 0, 3, 2],            # 뒤앞뒤좌앞뒤우앞 - 탐색 후퇴
    791: [0, 0, 1, 2, 0, 0, 3, 2],            # 뒤2좌앞뒤2우앞
    792: [0, 0, 3, 2, 0, 0, 1, 2],            # 뒤2우앞뒤2좌앞
    793: [1, 1, 0, 0, 3, 3, 2, 2],            # 좌2뒤2우2앞2 - S회피
    794: [3, 3, 0, 0, 1, 1, 2, 2],            # 우2뒤2좌2앞2 - 역S회피
    795: [2, 1, 0, 3, 2, 1, 0, 3],            # (앞좌뒤우)x2 - 복잡 기동
    796: [2, 3, 0, 1, 2, 3, 0, 1],            # (앞우뒤좌)x2 - 복잡 기동
    797: [0, 1, 2, 3, 0, 1, 2, 3],            # (뒤좌앞우)x2
    798: [0, 3, 2, 1, 0, 3, 2, 1],            # (뒤우앞좌)x2
    799: [2, 1, 0, 2, 3, 0, 2, 1, 0, 2],      # 앞좌뒤앞우뒤앞좌뒤앞 - 복잡 탐색 - 10개
})

# ===== 예약된 슬롯 (800-998) =====
# 향후 확장용
for i in range(800, 999):
    FUNCTION_LIBRARY[i] = [2]  # 기본값: 앞 1칸


def get_function(func_id):
    """
    함수 ID로 본문 가져오기

    Args:
        func_id: int (113-998)

    Returns:
        List[int] - 함수 본문
    """
    return FUNCTION_LIBRARY.get(func_id, [2])  # fallback: 앞 1칸


def parse_and_execute(tokens, game):
    """
    10토큰 파싱 및 실행

    핵심 로직:
    1. 첫 번째 함수 ID(113-998) → F1 저장, 메인에 10 추가
    2. 두 번째 함수 ID(113-998) → F2 저장, 메인에 11 추가
    3. 일반 명령(0-112) → 메인에 추가
    4. 999 → skip

    제약사항:
    - 함수 종류: 최대 2개 (F1, F2만)
    - 함수 호출: 총 4번까지 (10, 11 합쳐서)

    Args:
        tokens: List[int], 길이 10
        game: Game instance

    Returns:
        f1_body: List[int] - F1 본문
        f2_body: List[int] - F2 본문
        main_program: List[int] - 메인 프로그램
    """
    f1_body = []
    f2_body = []
    main_program = []

    f1_defined = False
    f2_defined = False

    for token in tokens:
        # 빈칸 skip
        if token == 999:
            continue

        # 함수 라이브러리 ID
        elif 113 <= token <= 998:
            if not f1_defined:
                # 첫 번째 함수 → F1
                f1_body = get_function(token)
                main_program.append(10)  # F1 호출 추가
                f1_defined = True

            elif not f2_defined:
                # 두 번째 함수 → F2
                f2_body = get_function(token)
                main_program.append(11)  # F2 호출 추가
                f2_defined = True

            # 세 번째 이상은 무시 (2종류 제약)

        else:
            # 일반 명령 (0-112)
            main_program.append(token)
            if token == 112:  # END
                break

    # 게임 설정
    game.function[0] = f1_body  # 8번 버튼 효과
    game.function[1] = f2_body  # 9번 버튼 효과
    game.command = main_program  # 10, 11 호출 포함

    # ✅ exe3.py의 typing_op(7) 사용: 검증 + 실제 게임 실행
    # btn==7 (Run 버튼)은 다음을 수행:
    # 1. 문법 검증 (LOOP, IF 구조)
    # 2. func_chance 검증 (함수 호출 제한)
    # 3. Cyclic dependency 검증
    # 4. 검증 통과 시 running_op() 실행
    game.typing_op(7)

    # 초기화 (다음 스텝 준비)
    game.function[0] = []
    game.function[1] = []

    return f1_body, f2_body, main_program


def get_library_stats():
    """라이브러리 통계"""
    return {
        'total_functions': len(FUNCTION_LIBRARY),
        'tier1': sum(1 for k in FUNCTION_LIBRARY if 113 <= k < 200),
        'tier2': sum(1 for k in FUNCTION_LIBRARY if 200 <= k < 300),
        'tier3': sum(1 for k in FUNCTION_LIBRARY if 300 <= k < 400),
        'tier4': sum(1 for k in FUNCTION_LIBRARY if 400 <= k < 600),
        'tier5': sum(1 for k in FUNCTION_LIBRARY if 600 <= k < 999),
    }


if __name__ == "__main__":
    # 테스트
    stats = get_library_stats()
    print("함수 라이브러리 통계:")
    for k, v in stats.items():
        print(f"  {k}: {v}")

    print(f"\n예시 함수:")
    print(f"  113: {get_function(113)}")  # 좌+앞
    print(f"  205: {get_function(205)}")  # LOOP 앞7
    print(f"  300: {get_function(300)}")  # 앞2+좌+앞2

    # parse_and_execute 제약 테스트 (게임 객체 없이 간단 시뮬레이션)
    print("\n" + "="*50)
    print("parse_and_execute 제약 테스트")
    print("="*50)

    class MockGame:
        def __init__(self):
            self.function = [[], []]
            self.command = []
            self.func_chance = 4  # ✅ 초기값 4번
            self.func_chance_to_use = 0
            self.valid = True
        def running_op(self):
            pass

    # 테스트 1: Valid - 2종류, 4번 호출
    print("\n--- Test 1: Valid (2종류, 4번) ---")
    tokens1 = [113, 200, 10, 11, 112, 0, 0, 0, 0, 0]
    game1 = MockGame()
    f1, f2, main = parse_and_execute(tokens1, game1)
    func_count = sum(1 for t in main if t in [10, 11])
    print(f"Tokens: {tokens1}")
    print(f"Main program: {main}")
    print(f"Function calls: {func_count} (expected: 4)")
    assert func_count == 4, f"Expected 4 calls, got {func_count}"
    print("✅ Test 1 passed!")

    # 테스트 2: Invalid - 5번 호출 시도 → 게임 검증에서 거부
    print("\n--- Test 2: 5번 호출 시도 → 게임 검증에서 거부 ---")
    tokens2 = [113, 10, 10, 10, 10, 112, 0, 0, 0, 0]  # F1 정의 + 10 4번 = 총 5번
    game2 = MockGame()
    f1, f2, main = parse_and_execute(tokens2, game2)
    func_count = sum(1 for t in main if t in [10, 11])
    print(f"Tokens: {tokens2}")
    print(f"Main program: {main}")
    print(f"Function calls: {func_count} (5 calls total)")
    print(f"Game validation: func_chance_to_use={game2.func_chance_to_use}, valid={game2.valid}")
    assert func_count == 5, f"Expected 5 calls, got {func_count}"
    # ✅ 게임 검증: 5번은 4번 초과이므로 valid=False여야 함
    assert game2.valid == False, f"Expected game.valid=False (5 > 4 limit), got {game2.valid}"
    print("✅ Test 2 passed!")

    # 테스트 3: Invalid - 3종류 시도 → F1, F2만 정의
    print("\n--- Test 3: 3종류 시도 → F1, F2만 정의 ---")
    tokens3 = [113, 114, 115, 0, 112, 0, 0, 0, 0, 0]
    game3 = MockGame()
    f1, f2, main = parse_and_execute(tokens3, game3)
    func_count = sum(1 for t in main if t in [10, 11])
    print(f"Tokens: {tokens3}")
    print(f"Main program: {main}")
    print(f"Function calls: {func_count} (expected: 2, F1+F2 only)")
    assert func_count == 2, f"Expected 2 calls (F1+F2 only), got {func_count}"
    print("✅ Test 3 passed!")

    # 테스트 4: Edge case - 정확히 4번 (valid=True)
    print("\n--- Test 4: 정확히 4번 (valid=True) ---")
    tokens4 = [113, 200, 10, 11, 112, 0, 0, 0, 0, 0]  # F1, F2 정의 + 10, 11 각 1번 = 총 4번
    game4 = MockGame()
    f1, f2, main = parse_and_execute(tokens4, game4)
    func_count = sum(1 for t in main if t in [10, 11])
    print(f"Tokens: {tokens4}")
    print(f"Main program: {main}")
    print(f"Function calls: {func_count} (expected: 4)")
    print(f"Game validation: func_chance_to_use={game4.func_chance_to_use}, valid={game4.valid}")
    assert func_count == 4, f"Expected 4 calls, got {func_count}"
    assert game4.valid == True, f"Expected game.valid=True (4 == 4 limit), got {game4.valid}"
    print("✅ Test 4 passed!")

    print("\n" + "="*50)
    print("✅ All constraint tests passed!")
    print("="*50)
